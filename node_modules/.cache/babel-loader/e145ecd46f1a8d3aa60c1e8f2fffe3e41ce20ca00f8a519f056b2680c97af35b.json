{"ast":null,"code":"```javascript\nimport React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Edit, Save, X, CheckCircle, Clock, AlertCircle, CreditCard } from 'lucide-react';\nimport ProgressBar from './ProgressBar';\n\nconst EditableCard = ({ \n  data, \n  onSave, \n  type = 'stage', // 'stage' or 'expense'\n  currency = '₹' \n}) => {\n  const [isEditing, setIsEditing] = useState(false);\n  const [showPaymentModal, setShowPaymentModal] = useState(false);\n  const [paymentAmount, setPaymentAmount] = useState('');\n  const [formData, setFormData] = useState({ ...data });\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  const handleSave = () => {\n    onSave(data.id, formData);\n    setIsEditing(false);\n  };\n\n  const handleCancel = () => {\n    setFormData({ ...data });\n    setIsEditing(false);\n  };\n\n  const handlePaymentSubmit = (e) => {\n    e.preventDefault();\n    const amount = Number(paymentAmount);\n    if (amount > 0) {\n      const newPaid = Number(data.paid) + amount;\n      onSave(data.id, { ...data, paid: newPaid });\n      setShowPaymentModal(false);\n      setPaymentAmount('');\n    }\n  };\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'completed': return 'var(--success)';\n      case 'paid': return 'var(--success)';\n      case 'in-progress': return 'var(--warning)';\n      case 'pending': return 'var(--text-light)'; // Grayish\n      default: return 'var(--text-light)';\n    }\n  };\n\n  const getStatusIcon = (status) => {\n    switch (status) {\n      case 'completed': return <CheckCircle size={16} />;\n      case 'paid': return <CheckCircle size={16} />;\n      case 'in-progress': return <Clock size={16} />;\n      default: return <AlertCircle size={16} />;\n    }\n  };\n\n  // Calculate progress for the bar\n  const progress = (data.paid / data.amount) * 100;\n\n  return (\n    <>\n      <motion.div \n        className=\"card editable-card\"\n        whileHover={{ y: -5 }}\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        style={{\n              <input \n                type=\"text\" \n                name=\"name\" \n                value={formData.name} \n                onChange={handleInputChange} \n                className=\"form-control\"\n              />\n            </div>\n            \n            {type === 'stage' && (\n               <div className=\"form-group\">\n                <label>Status</label>\n                <select \n                  name=\"status\" \n                  value={formData.status} \n                  onChange={handleInputChange}\n                  className=\"form-control\"\n                  disabled // Status is auto-updated now\n                >\n                  <option value=\"pending\">Not Started</option>\n                  <option value=\"in-progress\">In Progress</option>\n                  <option value=\"completed\">Completed</option>\n                </select>\n                <small style={{ fontSize: '0.7rem', opacity: 0.7 }}>Status updates automatically based on payment.</small>\n              </div>\n            )}\n\n            <div className=\"form-group\">\n              <label>Description</label>\n              <textarea \n                name=\"notes\" \n                value={formData.notes || ''} \n                onChange={handleInputChange} \n                className=\"form-control\"\n                rows=\"2\"\n              />\n            </div>\n\n            <div className=\"actions\" style={{ display: 'flex', gap: '10px', marginTop: '15px' }}>\n              <button onClick={handleSave} className=\"btn btn-success\" style={{ flex: 1 }}>\n                <Save size={16} /> Save\n              </button>\n              <button onClick={handleCancel} className=\"btn btn-secondary\" style={{ flex: 1 }}>\n                <X size={16} /> Cancel\n              </button>\n            </div>\n          </div>\n        ) : (\n          <div className=\"view-mode\">\n            <div className=\"card-header\" style={{ borderBottom: 'none', paddingBottom: 0, marginBottom: '10px' }}>\n              <h3 style={{ fontSize: '1.2rem', color: 'var(--text-dark)' }}>{data.name}</h3>\n              <span className=\"status-badge\" style={{ \n                display: 'flex', \n                alignItems: 'center', \n                gap: '5px',\n                color: getStatusColor(data.status),\n                fontSize: '0.8rem',\n                fontWeight: 'bold',\n                textTransform: 'uppercase'\n              }}>\n                {getStatusIcon(data.status)}\n                {data.status.replace('-', ' ')}\n              </span>\n            </div>\n\n            <div className=\"card-body\">\n              <p style={{ fontSize: '0.9rem', color: 'var(--text-dark)', opacity: 0.7, marginBottom: '15px', minHeight: '40px' }}>\n                {data.notes || 'No description provided.'}\n              </p>\n\n              <div className=\"financials\" style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px', marginBottom: '15px' }}>\n                <div>\n                  <label style={{ fontSize: '0.75rem', opacity: 0.7 }}>Total</label>\n                  <div style={{ fontWeight: 'bold' }}>{currency}{parseInt(data.amount).toLocaleString('en-IN')}</div>\n                </div>\n                <div>\n                  <label style={{ fontSize: '0.75rem', opacity: 0.7 }}>Paid</label>\n                  <div style={{ color: 'var(--success)', fontWeight: 'bold' }}>{currency}{parseInt(data.paid).toLocaleString('en-IN')}</div>\n                </div>\n                <div style={{ gridColumn: 'span 2' }}>\n                  <label style={{ fontSize: '0.75rem', opacity: 0.7 }}>Balance</label>\n                  <div style={{ color: 'var(--danger)', fontWeight: 'bold' }}>\n                    {currency}{(data.amount - data.paid).toLocaleString('en-IN')}\n                  </div>\n                </div>\n              </div>\n\n              <ProgressBar progress={progress} color={getStatusColor(data.status)} />\n            </div>\n\n            <div className=\"card-footer\" style={{ marginTop: '20px', display: 'flex', gap: '10px' }}>\n              <button onClick={() => setShowPaymentModal(true)} className=\"btn btn-primary btn-sm\" style={{ flex: 1 }}>\n                <CreditCard size={16} /> Add Payment\n              </button>\n              <button onClick={() => setIsEditing(true)} className=\"btn btn-secondary btn-sm\">\n                <Edit size={16} />\n              </button>\n            </div>\n          </div>\n        )}\n      </motion.div>\n\n      {/* Payment Modal */}\n      <AnimatePresence>\n        {showPaymentModal && (\n          <motion.div \n            className=\"modal-overlay\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              background: 'rgba(0,0,0,0.8)',\n              display: 'flex',\n              justifyContent: 'center',\n              alignItems: 'center',\n              zIndex: 2000\n            }}\n          >\n            <motion.div \n              className=\"modal-content card\"\n              initial={{ scale: 0.9, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.9, opacity: 0 }}\n              style={{ width: '90%', maxWidth: '400px', background: 'var(--card-bg-light)', color: 'var(--text-dark)' }}\n            >\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>\n                <h3>Add Payment for {data.name}</h3>\n                <button onClick={() => setShowPaymentModal(false)} style={{ background: 'none', border: 'none', cursor: 'pointer' }}>\n                  <X size={24} />\n                </button>\n              </div>\n\n              <div style={{ marginBottom: '20px', padding: '15px', background: 'rgba(0,0,0,0.05)', borderRadius: '8px' }}>\n                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '5px' }}>\n                  <span>Total Amount:</span>\n                  <strong>{currency}{data.amount.toLocaleString('en-IN')}</strong>\n                </div>\n                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '5px' }}>\n                  <span>Already Paid:</span>\n                  <strong style={{ color: 'var(--success)' }}>{currency}{data.paid.toLocaleString('en-IN')}</strong>\n                </div>\n                <div style={{ display: 'flex', justifyContent: 'space-between', borderTop: '1px solid #ccc', paddingTop: '5px' }}>\n                  <span>Remaining Balance:</span>\n                  <strong style={{ color: 'var(--danger)' }}>{currency}{(data.amount - data.paid).toLocaleString('en-IN')}</strong>\n                </div>\n              </div>\n\n              <form onSubmit={handlePaymentSubmit}>\n                <div className=\"form-group\" style={{ marginBottom: '20px' }}>\n                  <label>Enter Amount to Pay</label>\n                  <input \n                    type=\"number\" \n                    className=\"form-control\" \n                    value={paymentAmount}\n                    onChange={(e) => setPaymentAmount(e.target.value)}\n                    max={data.amount - data.paid}\n                    min=\"1\"\n                    required\n                    autoFocus\n                  />\n                </div>\n                <button type=\"submit\" className=\"btn btn-primary\" style={{ width: '100%' }}>\n                  Confirm Payment\n                </button>\n              </form>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </>\n  );\n};\n\nexport default EditableCard;\n```;","map":{"version":3,"names":[],"sources":["E:/House Details/pgk-construction/src/components/EditableCard.js"],"sourcesContent":["```javascript\r\nimport React, { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { Edit, Save, X, CheckCircle, Clock, AlertCircle, CreditCard } from 'lucide-react';\r\nimport ProgressBar from './ProgressBar';\r\n\r\nconst EditableCard = ({ \r\n  data, \r\n  onSave, \r\n  type = 'stage', // 'stage' or 'expense'\r\n  currency = '₹' \r\n}) => {\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [showPaymentModal, setShowPaymentModal] = useState(false);\r\n  const [paymentAmount, setPaymentAmount] = useState('');\r\n  const [formData, setFormData] = useState({ ...data });\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n  const handleSave = () => {\r\n    onSave(data.id, formData);\r\n    setIsEditing(false);\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setFormData({ ...data });\r\n    setIsEditing(false);\r\n  };\r\n\r\n  const handlePaymentSubmit = (e) => {\r\n    e.preventDefault();\r\n    const amount = Number(paymentAmount);\r\n    if (amount > 0) {\r\n      const newPaid = Number(data.paid) + amount;\r\n      onSave(data.id, { ...data, paid: newPaid });\r\n      setShowPaymentModal(false);\r\n      setPaymentAmount('');\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status) => {\r\n    switch (status) {\r\n      case 'completed': return 'var(--success)';\r\n      case 'paid': return 'var(--success)';\r\n      case 'in-progress': return 'var(--warning)';\r\n      case 'pending': return 'var(--text-light)'; // Grayish\r\n      default: return 'var(--text-light)';\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status) => {\r\n    switch (status) {\r\n      case 'completed': return <CheckCircle size={16} />;\r\n      case 'paid': return <CheckCircle size={16} />;\r\n      case 'in-progress': return <Clock size={16} />;\r\n      default: return <AlertCircle size={16} />;\r\n    }\r\n  };\r\n\r\n  // Calculate progress for the bar\r\n  const progress = (data.paid / data.amount) * 100;\r\n\r\n  return (\r\n    <>\r\n      <motion.div \r\n        className=\"card editable-card\"\r\n        whileHover={{ y: -5 }}\r\n        initial={{ opacity: 0, y: 20 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        style={{\r\n              <input \r\n                type=\"text\" \r\n                name=\"name\" \r\n                value={formData.name} \r\n                onChange={handleInputChange} \r\n                className=\"form-control\"\r\n              />\r\n            </div>\r\n            \r\n            {type === 'stage' && (\r\n               <div className=\"form-group\">\r\n                <label>Status</label>\r\n                <select \r\n                  name=\"status\" \r\n                  value={formData.status} \r\n                  onChange={handleInputChange}\r\n                  className=\"form-control\"\r\n                  disabled // Status is auto-updated now\r\n                >\r\n                  <option value=\"pending\">Not Started</option>\r\n                  <option value=\"in-progress\">In Progress</option>\r\n                  <option value=\"completed\">Completed</option>\r\n                </select>\r\n                <small style={{ fontSize: '0.7rem', opacity: 0.7 }}>Status updates automatically based on payment.</small>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"form-group\">\r\n              <label>Description</label>\r\n              <textarea \r\n                name=\"notes\" \r\n                value={formData.notes || ''} \r\n                onChange={handleInputChange} \r\n                className=\"form-control\"\r\n                rows=\"2\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"actions\" style={{ display: 'flex', gap: '10px', marginTop: '15px' }}>\r\n              <button onClick={handleSave} className=\"btn btn-success\" style={{ flex: 1 }}>\r\n                <Save size={16} /> Save\r\n              </button>\r\n              <button onClick={handleCancel} className=\"btn btn-secondary\" style={{ flex: 1 }}>\r\n                <X size={16} /> Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"view-mode\">\r\n            <div className=\"card-header\" style={{ borderBottom: 'none', paddingBottom: 0, marginBottom: '10px' }}>\r\n              <h3 style={{ fontSize: '1.2rem', color: 'var(--text-dark)' }}>{data.name}</h3>\r\n              <span className=\"status-badge\" style={{ \r\n                display: 'flex', \r\n                alignItems: 'center', \r\n                gap: '5px',\r\n                color: getStatusColor(data.status),\r\n                fontSize: '0.8rem',\r\n                fontWeight: 'bold',\r\n                textTransform: 'uppercase'\r\n              }}>\r\n                {getStatusIcon(data.status)}\r\n                {data.status.replace('-', ' ')}\r\n              </span>\r\n            </div>\r\n\r\n            <div className=\"card-body\">\r\n              <p style={{ fontSize: '0.9rem', color: 'var(--text-dark)', opacity: 0.7, marginBottom: '15px', minHeight: '40px' }}>\r\n                {data.notes || 'No description provided.'}\r\n              </p>\r\n\r\n              <div className=\"financials\" style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px', marginBottom: '15px' }}>\r\n                <div>\r\n                  <label style={{ fontSize: '0.75rem', opacity: 0.7 }}>Total</label>\r\n                  <div style={{ fontWeight: 'bold' }}>{currency}{parseInt(data.amount).toLocaleString('en-IN')}</div>\r\n                </div>\r\n                <div>\r\n                  <label style={{ fontSize: '0.75rem', opacity: 0.7 }}>Paid</label>\r\n                  <div style={{ color: 'var(--success)', fontWeight: 'bold' }}>{currency}{parseInt(data.paid).toLocaleString('en-IN')}</div>\r\n                </div>\r\n                <div style={{ gridColumn: 'span 2' }}>\r\n                  <label style={{ fontSize: '0.75rem', opacity: 0.7 }}>Balance</label>\r\n                  <div style={{ color: 'var(--danger)', fontWeight: 'bold' }}>\r\n                    {currency}{(data.amount - data.paid).toLocaleString('en-IN')}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <ProgressBar progress={progress} color={getStatusColor(data.status)} />\r\n            </div>\r\n\r\n            <div className=\"card-footer\" style={{ marginTop: '20px', display: 'flex', gap: '10px' }}>\r\n              <button onClick={() => setShowPaymentModal(true)} className=\"btn btn-primary btn-sm\" style={{ flex: 1 }}>\r\n                <CreditCard size={16} /> Add Payment\r\n              </button>\r\n              <button onClick={() => setIsEditing(true)} className=\"btn btn-secondary btn-sm\">\r\n                <Edit size={16} />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </motion.div>\r\n\r\n      {/* Payment Modal */}\r\n      <AnimatePresence>\r\n        {showPaymentModal && (\r\n          <motion.div \r\n            className=\"modal-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            style={{\r\n              position: 'fixed',\r\n              top: 0,\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 0,\r\n              background: 'rgba(0,0,0,0.8)',\r\n              display: 'flex',\r\n              justifyContent: 'center',\r\n              alignItems: 'center',\r\n              zIndex: 2000\r\n            }}\r\n          >\r\n            <motion.div \r\n              className=\"modal-content card\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              style={{ width: '90%', maxWidth: '400px', background: 'var(--card-bg-light)', color: 'var(--text-dark)' }}\r\n            >\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>\r\n                <h3>Add Payment for {data.name}</h3>\r\n                <button onClick={() => setShowPaymentModal(false)} style={{ background: 'none', border: 'none', cursor: 'pointer' }}>\r\n                  <X size={24} />\r\n                </button>\r\n              </div>\r\n\r\n              <div style={{ marginBottom: '20px', padding: '15px', background: 'rgba(0,0,0,0.05)', borderRadius: '8px' }}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '5px' }}>\r\n                  <span>Total Amount:</span>\r\n                  <strong>{currency}{data.amount.toLocaleString('en-IN')}</strong>\r\n                </div>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '5px' }}>\r\n                  <span>Already Paid:</span>\r\n                  <strong style={{ color: 'var(--success)' }}>{currency}{data.paid.toLocaleString('en-IN')}</strong>\r\n                </div>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', borderTop: '1px solid #ccc', paddingTop: '5px' }}>\r\n                  <span>Remaining Balance:</span>\r\n                  <strong style={{ color: 'var(--danger)' }}>{currency}{(data.amount - data.paid).toLocaleString('en-IN')}</strong>\r\n                </div>\r\n              </div>\r\n\r\n              <form onSubmit={handlePaymentSubmit}>\r\n                <div className=\"form-group\" style={{ marginBottom: '20px' }}>\r\n                  <label>Enter Amount to Pay</label>\r\n                  <input \r\n                    type=\"number\" \r\n                    className=\"form-control\" \r\n                    value={paymentAmount}\r\n                    onChange={(e) => setPaymentAmount(e.target.value)}\r\n                    max={data.amount - data.paid}\r\n                    min=\"1\"\r\n                    required\r\n                    autoFocus\r\n                  />\r\n                </div>\r\n                <button type=\"submit\" className=\"btn btn-primary\" style={{ width: '100%' }}>\r\n                  Confirm Payment\r\n                </button>\r\n              </form>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EditableCard;\r\n```\r\n"],"mappings":"AAAA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}